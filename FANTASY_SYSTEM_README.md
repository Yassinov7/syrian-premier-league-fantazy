# 🏆 نظام فانتازي الدوري السوري الممتاز - دليل المستخدم

## 📋 نظرة عامة

تم تطوير نظام فانتازي كرة القدم ليكون مشابهاً للعبة الدوري الإنجليزي الممتاز، مع دعم كلا النوعين من الدوريات (العام والخاص) ونظام تشكيلة مرن.

## 🚀 الميزات الجديدة

### 1. نظام التشكيلة المرن
- **الحد الأدنى:** 11 لاعب (تشكيلة أساسية)
- **الحد الأقصى:** 15 لاعب (4 احتياط)
- **توزيع مرن:**
  - حارس مرمى: 1-2 لاعب
  - مدافعون: 3-6 لاعبين
  - وسط: 3-6 لاعبين  
  - مهاجمون: 1-3 لاعبين

### 2. نظام الأساسيين والاحتياط
- **11 لاعب أساسيين** (يجب اختيارهم)
- **4 لاعب احتياط** (اختياري)
- **نظام النقاط:** فقط الأساسيين يحصلون على نقاط

### 3. نظام النقاط الجديد
- **نقاط الجولة الحالية** (وليس النقاط السابقة)
- **نقاط إضافية:** 
  - الكابتن: ×2 نقاط
  - نائب الكابتن: ×1.5 نقاط

### 4. نظام الدوريات
- **دوريات عامة:** مفتوحة للجميع
- **دوريات خاصة:** يمكن للمستخدمين إنشاؤها ودعوة الأصدقاء

## 🗄️ تحديث قاعدة البيانات

### الخطوة 1: تشغيل ملف SQL
قم بتشغيل ملف `database_updates.sql` في قاعدة البيانات الخاصة بك:

```sql
-- في Supabase SQL Editor أو أي أداة قاعدة بيانات
-- انسخ والصق محتوى database_updates.sql
```

### الخطوة 2: التحقق من الجداول الجديدة
بعد التشغيل، ستجد الجداول التالية:

- `leagues` - الدوريات
- `league_members` - أعضاء الدوريات
- `game_weeks` - أسابيع اللعب
- `transfers` - النقلات
- `player_weekly_performance` - أداء اللاعبين الأسبوعي

## 🎮 كيفية الاستخدام

### 1. اختيار الدوري
1. اذهب إلى صفحة "بناء الفريق"
2. اضغط على زر "اختيار الدوري"
3. اختر من الدوريات العامة أو أنشئ دوري خاص

### 2. إنشاء دوري خاص
1. اضغط على "إنشاء دوري خاص"
2. أدخل:
   - اسم الدوري
   - الوصف (اختياري)
   - الحد الأقصى للفرق
   - رسوم الانضمام
3. اضغط "إنشاء الدوري"

### 3. بناء الفريق
1. اختر 11-15 لاعب
2. حدد 11 لاعب أساسيين
3. اختر كابتن ونائب كابتن
4. تأكد من صحة التشكيلة
5. احفظ الفريق

### 4. إدارة التشكيلة
- **إضافة لاعب:** اضغط على اللاعب في القائمة
- **إزالة لاعب:** اضغط على اللاعب في التشكيلة
- **تغيير الأساسيين:** استخدم زر ✓/○
- **تعيين كابتن:** استخدم زر C
- **تعيين نائب كابتن:** استخدم زر VC

## 📊 قواعد النقاط

### النقاط الأساسية
- **هدف:** 4 نقاط
- **تمريرة حاسمة:** 3 نقاط
- **صافي المرمى:** 2 نقاط (للحارس والمدافعين)
- **دقائق اللعب:** نقطة واحدة لكل 90 دقيقة

### نقاط إضافية
- **الكابتن:** ×2 نقاط
- **نائب الكابتن:** ×1.5 نقاط
- **نقاط سلبية:**
  - بطاقة صفراء: -1 نقطة
  - بطاقة حمراء: -3 نقاط
  - هدف مستلم: -1 نقطة (للحارس والمدافعين)

## 🔄 نظام النقلات

### قواعد النقلات
- **عدد النقلات:** مرة واحدة كل جولة
- **الموعد النهائي:** قبل بداية الجولة
- **تكلفة النقل:** مجانية (يمكن تعديلها)

### كيفية النقل
1. اذهب إلى صفحة "إدارة الفريق"
2. اختر "النقلات"
3. اختر اللاعب المراد استبداله
4. اختر اللاعب الجديد
5. تأكد من صحة النقل
6. احفظ النقل

## 🏅 ترتيب الدوريات

### حساب النقاط
- **النقاط الإجمالية:** مجموع نقاط جميع الجولات
- **ترتيب الفرق:** حسب النقاط الإجمالية
- **في حالة التعادل:** حسب عدد الأهداف

### عرض الترتيب
- **الدوري العام:** ترتيب جميع الفرق
- **الدوري الخاص:** ترتيب فرق الدوري فقط

## 🛠️ الملفات المحدثة

### الملفات الرئيسية
- `app/team-selection/page.tsx` - صفحة اختيار الفريق
- `components/team-selection/TeamFormation.tsx` - تشكيلة الفريق
- `components/team-selection/SaveTeamModal.tsx` - حفظ الفريق
- `components/team-selection/LeagueSelector.tsx` - اختيار الدوري
- `lib/supabase.ts` - أنواع البيانات

### الملفات الجديدة
- `database_updates.sql` - تحديثات قاعدة البيانات
- `FANTASY_SYSTEM_README.md` - هذا الملف

## 🚨 استكشاف الأخطاء

### مشاكل شائعة

#### 1. لا يظهر اللاعبون المختارون سابقاً
**الحل:** تأكد من تشغيل ملف `database_updates.sql` وتحديث قاعدة البيانات

#### 2. خطأ في حفظ الفريق
**الحل:** تأكد من:
- اختيار دوري
- اختيار 11 لاعب أساسيين
- اختيار كابتن ونائب كابتن
- عدم تجاوز الميزانية

#### 3. خطأ في قاعدة البيانات
**الحل:** تحقق من:
- صحة الجداول الجديدة
- العلاقات بين الجداول
- الصلاحيات

### رسائل الخطأ
- **"يجب اختيار دوري"** - اختر دوري قبل حفظ الفريق
- **"يجب اختيار 11 لاعب أساسيين"** - حدد 11 لاعب في التشكيلة الأساسية
- **"تجاوزت الميزانية"** - قلل من تكلفة الفريق

## 🔮 الميزات المستقبلية

### المخطط لها
- [ ] نظام المباريات المباشرة
- [ ] إحصائيات مفصلة للاعبين
- [ ] نظام التحديات
- [ ] تطبيق الهاتف المحمول
- [ ] نظام المكافآت

### اقتراحات المستخدمين
- [ ] نظام الكابتن الثلاثي
- [ ] نقاط إضافية للمهارات
- [ ] نظام البطولات

## 📞 الدعم

### للمطورين
- تحقق من ملف `database_updates.sql`
- راجع أنواع البيانات في `lib/supabase.ts`
- تأكد من صحة العلاقات بين الجداول

### للمستخدمين
- تحقق من قواعد التشكيلة
- تأكد من اختيار دوري
- راجع رسائل الخطأ

## 🎯 الخلاصة

تم تطوير النظام ليكون:
- **مرناً** - تشكيلة قابلة للتخصيص
- **واقعياً** - مشابه للعبة الدوري الإنجليزي
- **اجتماعياً** - دوريات خاصة مع الأصدقاء
- **عادلاً** - نظام نقاط متوازن

---

**تم التطوير بواسطة فريق فانتازي الدوري السوري الممتاز** 🏆
